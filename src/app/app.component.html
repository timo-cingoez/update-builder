<div
  class="sticky top-0 z-40 w-full backdrop-blur flex-none mb-3" style="background-color: #323957;">

  <div class="relative flex items-center py-4 mx-4">

    <div class="flex items-center gap-2-5">

      <img width="32" height="32" src="assets/images/zip-folder.png">

      <span class="text-lg">{{ title }}</span>

      <span class="text-xs bg-zinc-500 border-zinc-400 rounded-full py-1 px-3">{{ version }}</span>

    </div>

    <div class="ml-auto flex gap-5">

      <a href="https://github.com/timo-cingoez/update-builder" target="_blank">
        <img width="32" height="32" src="assets/images/github.png">
      </a>

      <img width="32" height="32" src="assets/images/settings.png" (click)="toggleInfoPanelVisibility()">

      <div class="flex flex-col text-slate-500">
        <span>API URL: {{ apiUrl }}</span>
        <span>ROOT DIR: {{ rootDir }}</span>
      </div>

    </div>

  </div>

</div>


<div class="w-full flex flex-col items-center gap-2-5 mb-3">

  <div class="w-90 flex flex-col items-center gap-2-5">

    <ng-container *ngIf="selectedFiles.size; else noSelectedFiles">

      <cdk-virtual-scroll-viewport itemSize="20"
                                   class="selected-files overflow-auto h-60 w-full bg-zinc-900 border-2 border-solid border-zinc-400">

        <div *cdkVirtualFor="let fileData of selectedFiles"
             class="item px-1 flex flex-row justify-between gap-3 border-2 border-solid border-lime-700 text-gray-200 cursor-pointer bg-neutral-800 text-base"
             (click)="unselectFile(fileData)">

          <span class="flex items-center">{{ fileData.path }}</span>
          <span class="flex items-center">{{ fileData.size }}</span>
          <img width="32" height="32" [src]="'assets/images/' + fileData.extension + '.png'" alt="file extension image">

        </div>

      </cdk-virtual-scroll-viewport>

    </ng-container>


    <div class="flex flex-row gap-2-5">

      <button (click)="reset()"
              class="btn btn-reset bg-gray-300 text-base text-gray-800 font-bold py-2 px-4 rounded inline-flex items-center gap-2-5 cursor-pointer">
        <span>Reset</span>
        <img width="16" height="16" src="../assets/images/reset.png">
      </button>

      <button (click)="initZip()"
              class="btn btn-create bg-gray-300 text-base text-gray-800 font-bold py-1 px-3 rounded inline-flex items-center gap-2-5 cursor-pointer">
        <span>[ZIP!]</span>
        <img width="16" height="16" src="../assets/images/magic.png">
      </button>

    </div>

  </div>

  <div class="w-90 flex flex-row gap-2-5 mb-3">

    <div class="w-full flex flex-col items-center">

      <div class="w-full flex flex-col h-14 items-center justify-center">

        <label>Search for files ({{ searchResultCount }} results)</label>
        <input class="w-80" type="text" placeholder="Filename, e.g.: inc/User/Data.php"
               (input)="searchFiles($any($event.target).value)">

      </div>

      <ng-container *ngIf="searchedFiles.size; else noSearchedFiles">

        <cdk-virtual-scroll-viewport itemSize="30"
                                     class="viewport overflow-auto h-650 w-full bg-zinc-900 border-2 border-solid border-zinc-400">

          <div *cdkVirtualFor="let fileData of searchedFiles"
               class="item p-2 flex flex-row justify-between border-2 border-solid border-amber-700 text-gray-200 cursor-pointer bg-neutral-800 text-base"
               (click)="onSearchedFileClick(fileData)"
               [ngClass]="{'bg-amber-800': fileData.isSelected}">

            {{ fileData.path }}
            <img width="32" height="32" [src]="'assets/images/' + fileData.extension + '.png'"
                 alt="file extension image">

          </div>

        </cdk-virtual-scroll-viewport>

      </ng-container>

    </div>

    <div class="w-full flex flex-col">

      <div class="w-full flex items-center justify-center h-14 gap-2-5">

        <div class="flex flex-col">
          <label>Since</label>
          <input type="text" [(ngModel)]="commitSince" placeholder="YYYY-MM-DD / 1 day ago">
        </div>

        <div class="flex flex-col">
          <label>Until</label>
          <input type="text" [(ngModel)]="commitUntil" placeholder="YYYY-MM-DD / now">
        </div>

        <div class="flex">

          <button
            class="btn btn-reset bg-gray-300 text-base text-gray-800 font-bold py-2 px-4 rounded inline-flex items-center gap-2-5 cursor-pointer"
            (click)="toggleGitPanelVisibility()">info
          </button>
          <button
            class="btn btn-reset bg-gray-300 text-base text-gray-800 font-bold py-2 px-4 rounded inline-flex items-center gap-2-5 cursor-pointer"
            (click)="initAvailableCommits()">GET
          </button>

        </div>

      </div>

      <ng-container *ngIf="availableCommits.size; else noCommits">

        <cdk-virtual-scroll-viewport itemSize="30"
                                     class="viewport overflow-auto h-650 w-full bg-zinc-900 border-2 border-solid border-zinc-400">

          <div *cdkVirtualFor="let commit of availableCommits"
               class="item p-2 border-2 border-solid border-blue-700 text-gray-200 cursor-pointer bg-neutral-800 text-base"
               style="display: flex; flex-direction: column;" (click)="onCommitClick(commit)"
               [ngClass]="{'bg-blue-800': commit.isSelected}">

            <span>{{ commit.sha }} - {{ commit.author }} - {{ commit.datetime }}</span>
            <span>{{ commit.message }}</span>

          </div>

        </cdk-virtual-scroll-viewport>

      </ng-container>

    </div>

  </div>

</div>

<div class="flex flex-col gap-2-5 w-full items-center justify-center">
  <label>ZIP filename</label>
  <input type="text" [(ngModel)]="zipName" placeholder="Update_151123" class="w-80">
</div>

<div [class.block]="infoPanelVisible" class="info-panel">
  Currently excluded directories:
  {{ excludedDirs }}
  <br>
  <br>
  Amount of available files: {{ availableFilesCount }}
</div>

<div [class.block]="gitInfoPanelVisible" class="info-panel">

  <div class="flex flex-col gap-2-5">

    <span>Format options</span>

    <ul>

      <li>
        <span>Date Formats</span>
        <p>
          Relative formats: now, yesterday, 1 hour ago, 2 days ago, etc.
          <br>
          Absolute formats: 2023-01-01, 2023-01-01 12:00:00
        </p>
      </li>

      <li>
        <span>Relative to a Specific Commit</span>
        <p>
          Example: sha (e.g., HEAD, a commit hash)
        </p>
      </li>

      <li>
        <span>Reflog Specifier</span>
        <p>
          Example: HEAD@{{ '{' }}2.days.ago{{ '}' }}
        </p>
      </li>

    </ul>

  </div>

</div>


<ng-template #noSelectedFiles>

  <div
    class="flex items-center justify-center h-60 w-full bg-zinc-900 border-2 border-solid border-zinc-400 rounded-md">
    <span class="text-xl text-slate-500">Selected Files</span>
  </div>

</ng-template>


<ng-template #noCommits>

  <div
    class="flex items-center justify-center h-650 w-full bg-zinc-900 border-2 border-solid border-zinc-400 rounded-md">
    <span class="text-xl text-slate-500">Commits</span>
  </div>

</ng-template>


<ng-template #noSearchedFiles>

  <div
    class="flex items-center justify-center h-650 w-full bg-zinc-900 border-2 border-solid border-zinc-400 rounded-md">
    <span class="text-xl text-slate-500">Search Files</span>
  </div>

</ng-template>
